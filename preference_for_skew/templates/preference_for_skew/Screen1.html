{% extends "global/Base.html" %}
{% load staticfiles otree_tags %}

{% block title %}
    Screen 1
{% endblock %}

{% block content %}
<div id="realcontent" style="display:none;">
    <h3>Individuals makes a choice of wich lottery A-F</h3>
    <script type="text/javascript" src="http://kozea.github.com/pygal.js/latest/pygal-tooltips.min.js"></script>
    <figure size="25%">
        <!-- Pygal render() result: -->
        {{graph|safe}}
        <!-- End of Pygal render() result: -->
    </figure>
    <table class="table table-hover">
        <tr class="skewrow">
            <th class="lead text-info">1</th><td class="skews">{{form.skewchoice1}}</td>
        </tr>
    </table>
    {% next_button %}
</div>

    <style>
        ul.nobullets {
            padding-left: 20px;
        }

        ul.nobullets figure {
            display: inline;
        }
    </style>


    <script>
        $(document).ready(function(){

            var CHOICES = {{choices|safe}};
            var SQUARES = {{squares|safe}};

            $("tr.skewrow").each(function(sr_idx, row){
                var $row = $(row);
                var $labels = $row.find("td.skews label");

                $row.find("td.skews").remove();
                $labels.each(function(idx, label){
                    var $label = $(label);
                    $row.append("<td></td>");
                    var $td = $row.find("td:last");
                    $td.append(label);

                    $td.append("<ul class='nobullets'></ul>");
                    var $ul = $td.find("ul:last");

                    var choices = CHOICES[$label.text().trim()];
                    for(var idx=0; idx < choices.length; idx++){
                        var choice  = choices[idx];
                        var square = SQUARES[idx];
                        $ul.append('<li><figure>'+ square +'</figure>&nbsp;$' + choice.toFixed(2) + '</li>');
                    }
                });
            });

            window.setTimeout(function(){
                $("#realcontent").show();
            }, 2000);
        });
    </script>

{% endblock %}
